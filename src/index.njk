---
layout: base.njk
title: The Cozy Tales
class: "cozy-index-wrapper"
---

<!-- Main Content Area -->
<div class="cozy-main-content">

<div class="cozy-carousel-wrapper">
  <div class="carousel-decoration"></div>

  <div class="carousel-content-wrapper">
    <!-- Sticky Welcome Card -->
    <div class="welcome-card">
      <h2>Welcome to Cozy Tales!</h2>
      <p>
      Your cozy corner for indie games, crafts and diy, and books! </p>
       <!-- Buy Me a Coffee Section -->
      <div class="sidebar-section buy-coffee">
        <a href="https://buymeacoffee.com/thecozytales" target="_blank" rel="noopener noreferrer">
          <img src="/assets/buymeacoffee.png" alt="Buy Me a Coffee" style="max-width: 100%; border-radius: 12px;" />
        </a>
      </div>
      <a href="/all-posts/" class="welcome-btn">See All Posts</a>
      
    </div>

    <!-- Carousel Container -->
    <div class="carousel-container">
      <div class="carousel-track" id="carouselTrack">
        {% for post in collections.latestAddedPosts %}
          <div class="carousel-slide">
            {% set url = post.url %}
            {% set title = post.data.title %}
            {% set excerpt = post.data.excerpt %}
            {% set headerImage = post.data.headerImage %}
            {% set date = post.data.date %}
            {% include "post-card.njk" %}
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>


<section class="featured-section">
  <h2>Featured Game Blogs</h2>
  <div class="grid">
    {% for post in collections.gameBlogs | slice(0,3) %}
      {% set url = post.url %}
      {% set title = post.data.title %}
      {% set excerpt = post.data.excerpt %}
      {% set date = post.data.date %}
      {% set headerImage = post.data.headerImage %}
      {% include "post-card.njk" %}
    {% endfor %}
  </div>
  <a href="/game-blogs/" class="btn-link">View all game blogs</a>
</section>

<section class="featured-section">
  <h2>Featured Crafts & DIY</h2>
  <div class="grid">
    {% for post in collections.craftsArts | slice(0,3) %}
      {% set url = post.url %}
      {% set title = post.data.title %}
      {% set excerpt = post.data.excerpt %}
      {% set date = post.data.date %}
      {% set headerImage = post.data.headerImage %}
      
        {% include "post-card.njk" %}
      
    {% endfor %}
  </div>
  <a href="/crafts-arts/" class="btn-link">View all crafts & DIY</a>
</section>

<section class="featured-section">
  <h2>Top Book Stories</h2>
  <div class="grid">
    {% for post in collections.bookBlogs | slice(0,3) %}
      {% set url = post.url %}
      {% set title = post.data.title %}
      {% set excerpt = post.data.excerpt %}
      {% set date = post.data.date %}
      {% set headerImage = post.data.headerImage %}
      {% include "post-card.njk" %}
    {% endfor %}
  </div>
  <a href="/book-blogs/" class="btn-link">Explore all books & stories</a>
</section>


<!-- Newsletter Section -->
<section class="sidebar-newsletter">
  <div class="sidebar-newsletter-content">
    <h2 class="sidebar-newsletter-title">ðŸ§¸ Stay Cozy! ðŸ§¸</h2>
    <p class="sidebar-newsletter-text">Get the latest posts, exclusive content, and creative resources delivered to your inbox!</p>
        <form
        class="sidebar-newsletter-form"
        action="https://docs.google.com/forms/d/e/1FAIpQLSeG6Ax88MT8R91J_Ga0-qrs8j-ZG2lT5xEDM1u8vxEEuUceHA/formResponse"
        method="POST"
        target="_blank"
      >
        <input
          type="email"
          name="entry.1345713534"
          placeholder="Your email address..."
          required
          class="sidebar-newsletter-input"
        />
        <button type="submit" class="sidebar-newsletter-btn cozy-btn cozy-btn-cocoa">
          Join The Cozy Tales!
        </button>
      </form>

  </div>
</section>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const track = document.querySelector("#carouselTrack");
  const container = document.querySelector(".carousel-container");
  const slides = Array.from(track.children);

  const AUTO_PLAY_INTERVAL = 3000; 
  let autoPlayTimer = null;
  let isTransitioning = false;

  let currentSlide = 0;
  let slideWidth = 0;
  let maxSlide = slides.length - 1;
  let visibleSlides = 1;

  function updateSlideWidth() {
    slideWidth = slides[0].offsetWidth + 16; // 16 = gap
    maxSlide = slides.length - 1;
    visibleSlides = Math.floor(container.offsetWidth / slideWidth);
  }

  function updateCarousel() {
    const maxIndex = maxSlide - visibleSlides + 1;
    if (currentSlide > maxIndex) currentSlide = 0; // safety check
    const offset = -(slideWidth * currentSlide);
    track.style.transform = `translateX(${offset}px)`;
    track.style.transition = "transform 0.5s ease-in-out";
  }

  function nextSlide() {
    if (isTransitioning) return;
    isTransitioning = true;
    const maxIndex = maxSlide - visibleSlides + 1;
    currentSlide = currentSlide + 1 > maxIndex ? 0 : currentSlide + 1;
    updateCarousel();
    setTimeout(() => (isTransitioning = false), 350);
  }

  // Autoplay functions
  function startAutoPlay() {
    stopAutoPlay();
    autoPlayTimer = setInterval(() => {
      nextSlide();
    }, AUTO_PLAY_INTERVAL);
  }

  function stopAutoPlay() {
    if (autoPlayTimer) {
      clearInterval(autoPlayTimer);
      autoPlayTimer = null;
    }
  }

  // Pause autoplay on hover over carousel-wrapper or track
  [track, document.querySelector(".cozy-carousel-wrapper")].forEach(el => {
    if (!el) return;
    el.addEventListener("mouseenter", stopAutoPlay);
    el.addEventListener("mouseleave", startAutoPlay);
  });

  // Swipe support
  let touchStartX = 0;
  let touchEndX = 0;
  let isSwiping = false;

  track.addEventListener("touchstart", (e) => {
    touchStartX = e.changedTouches[0].screenX;
    isSwiping = true;
  });

  track.addEventListener("touchmove", (e) => {
    if (!isSwiping) return;
    e.preventDefault();
  });

  track.addEventListener("touchend", (e) => {
    if (!isSwiping) return;
    touchEndX = e.changedTouches[0].screenX;
    const deltaX = touchStartX - touchEndX;
    const maxIndex = maxSlide - visibleSlides + 1;

    if (Math.abs(deltaX) > 50) {
      if (deltaX > 0) {
        nextSlide();
      } else {
        currentSlide = (currentSlide - 1 + maxIndex + 1) % (maxIndex + 1);
        updateCarousel();
      }
    }
    isSwiping = false;
  });

  // Resize support
  window.addEventListener("resize", () => {
    updateSlideWidth();
    updateCarousel();
  });

  const resizeObserver = new ResizeObserver(() => {
    updateSlideWidth();
    updateCarousel();
  });
  resizeObserver.observe(track);

  // Initial setup
  updateSlideWidth();
  updateCarousel();
  startAutoPlay();
});

</script>
